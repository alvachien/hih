<body>

	<div id="content">
		<link href="css/themes/default/easyui.css" rel="stylesheet">

		<div style="margin: 50px 0;"></div>
		<div style="min-height: 200px;" align="center">
			<div style="margin: 20px 0;"></div>

			<div class="easyui-panel" title="Login into the system"
				id="loginPanel" style="width: 70%; padding: 30px 70px 20px 70px">
				<form id="formLogin" class="easyui-form" method="post">
					<table style="width: 70%">
						<tr>
							<td data-i18n="Login.User">User:</td>
							<td>
								<div style="margin-bottom: 10px">
									<input class="easyui-textbox" name="loginuser"
										style="width: 100%; height: 30px; padding: 12px"
										data-options="prompt:'User name',iconCls:'icon-man',iconWidth:38, required: true,validType:'length[6,25]'">
								</div>
							</td>
						</tr>
						<tr>
							<td data-i18n="Login.Password">Password:</td>
							<td>
								<div style="margin-bottom: 20px">
									<input class="easyui-textbox" type="password" name="pass"
										style="width: 100%; height: 30px; padding: 12px"
										data-options="prompt:'Password',iconCls:'icon-lock',iconWidth:38, required: true,validType:'length[6,50]'">
								</div>
							</td>
						</tr>
						<tr>
							<td data-i18n="Common.Language">Language:</td>
							<td>
								<div style="margin-bottom: 20px">
									<select id="langCombo" class="easyui-combobox" name="lang"
										data-options="onSelect: langComboSelect" style="width: 100%;">
										<option value="en" selected="selected">English</option>
										<option value="zh">简体中文</option>
									</select>
								</div>
							</td>
						</tr>
						<tr>
							<td></td>
							<td>
								<div align="right">
									<a href="javascript:void(0)" class="easyui-linkbutton"
										onclick="registerClick()"
										style="padding: 5px 0px; width: 30%;"> <span
										style="font-size: 14px;" data-i18n="Login.Register">Register</span>
									</a> <a href="javascript:void(0)" class="easyui-linkbutton"
										data-options="iconCls:'icon-ok'" onclick="submitForm()"
										style="padding: 5px 0px; width: 30%;"> <span
										style="font-size: 14px;" data-i18n="Login.Login">Login</span>
									</a> <a href="javascript:void(0)" class="easyui-linkbutton"
										data-options="iconCls:'icon-cancel'" onclick="clearForm()"
										style="padding: 5px 0px; width: 30%;"> <span
										style="font-size: 14px;" data-i18n="Common.Clear">Clear</span>
									</a>
								</div>
							</td>
						</tr>
					</table>
				</form>
			</div>
		</div>
	</div>

	<div id="footer" align="center">
		<div>Copyright © 2014 - 2015 Alva Chien</div>
	</div>

	<script>
		//var i18n_option = { lng: "zh", ns: 'resource'  }; 
		var selLng = 'en'; // Set Default language here!!!
		var i18n_option = { 
				ns: { 
				    namespaces: ['resource'], 
				    defaultNs: 'resource'
				  } ,
				lng: selLng	
		};
				 
		i18n.init(i18n_option, function(t) {
			  // access default namespace
			  //var x = t("Login.Password");
			  //alert(x);
			$("#content").i18n();
			var titlestr = t('Login.LoginTitle');
			$('#loginPanel').panel('setTitle', titlestr);
		});

		$('#formLogin').form({
			url : 'user_login.php',
			onSubmit : function() {
				return $(this).form('validate');
			},
			success : function(data) {
				var jsonData;
				try {
					jsonData = JSON && JSON.parse(data) || $.parseJSON(data);
				} catch (e) {
					$.messager.alert('Error', e.description + data, 'Error');
				}
				if (jsonData.type === 'E') {
					$.messager.alert('Error', jsonData.Message, 'error');
				} else {
					//window.location.href = "index.php";
					window.location.href = "index.php?setLng=" + selLng;
				}
			}
		});

		function submitForm() {
			$('#formLogin').form('submit');
		}
		function clearForm() {
			$('#formLogin').form('clear');
		}
		function close_window() {
			// Try 0. Not working!!!!
			//window.close();
			// Try 1. Not working!!!!!!!
			//window.open("", "_self").close();
			// Try 2. Not working either!!!!!!
			//window.top.close();
			// Try 3. Not working, again!!!!!!
			// window.open('','_parent','').close();
		}
		function registerClick() {
			window.location.href = "user_register.php?setLng=" + selLng;
		}
		function langComboSelect(record) {
			selLng = record.value;
			
			i18n.setLng(selLng, function(t) 
				{ 
					$("#content").i18n();
					var titlestr = i18n.t('Login.LoginTitle');
					$('#loginPanel').panel('setTitle', titlestr); 
				});			
		}
	</script>
</body>
</html>
